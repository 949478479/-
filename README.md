# GraffitiBoard

学习 `Quartz 2D` 过程中鼓捣的一个手势解锁和涂鸦板~

###实现的功能

* 手势解锁.
* 瞎胡画...
* 画一些基本几何图形,例如直线,虚线,矩形,方形,椭圆,圆.还可以画箭头.
* 橡皮擦除功能.
* 调节线条粗细,颜色,还可以根据 *ARGB* 值改颜色.有个预览小窗口.
* 可以撤销,重做,清屏,保存.
* 可以从相册选择一张图片作为背景在上面涂鸦.

###技术细节

* 利用 `CALayer` 的 `drawInContext:` 实现自定义绘图.
* 计算最小重绘矩形范围配合 `setNeedsDisplayInRect:` 尽量减小重绘区域.
* 开启了 `drawsAsynchronously`.
* 将之前的复杂路径直接作为位图渲染.
* 用 `kCGBlendModeClear` 实现橡皮功能.
* 用 `renderInContext:` 将照片图层连同用于涂鸦的子图层保存为图片.

###备注

最近学习了一些 `Quartz 2D` 和优化图形性能的博客,就把以前写的手势解锁和涂鸦板改进并完善了下.= =穷人没有真机设备,只能在模拟器上跑,用 `instrument` 测了测,涂满一屏的情况下性能也还可以.本来还想试试用 `CAShapeLayer` 看能不能实现画出的图案还能拖动那种,还有输入文字的功能,可是不太理想...另外撤销和重做功能为了避免内存占用,很粗暴地通过读写沙盒实现,虽然通过 `GCD` 在后台去做,并没有明显卡顿.还有就是不知道咋判断橡皮擦没擦干净,所以使用橡皮时撤销/重做的按钮交互状态有时略显莫名其妙...
